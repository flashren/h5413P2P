"use strict";$(function(){$("#regForm").bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{username:{message:"用户名验证失败",validators:{notEmpty:{message:"用户名不能为空"},stringLength:{min:6,max:18,message:"用户名长度必须在6~18位之间"}}},password1:{validators:{notEmpty:{message:"密码必须填写"},stringLength:{min:6,message:"密码长度必须大于6位"}}},password2:{validators:{notEmpty:{message:"确认密码必须填写"},identical:{field:"password1",message:"两次密码输入不一致"}}},realname:{validators:{notEmpty:{message:"真实姓名不能为空"}}},mobile:{validators:{notEmpty:{message:"手机号码必须填写"},regexp:{regexp:/^[1][3,4,5,7,8,9][0-9]{9}$/,message:"手机号码格式不正确，格式：13900000000"}}},sex:{validators:{notEmpty:{message:"请选择性别"}}},isAgree:{validators:{notEmpty:{message:"请选择查看注册协议并同意"}}}}}).on("success.form.bv",function(s){s.preventDefault();var o=$(s.target),e=(o.data("bootstrapValidator"),o.serialize());console.log("发送的数据",e),$.post("api/userAdd.php",e,function(s){if(console.log("服务器返回结果",s),$("#regLoginModal .modal-title").text("用户注册提示"),s.isSuccess){$("#regLoginModal .modal-body").html("<span class='glyphicon glyphicon-ok'></span>"+s.msg+"等待 <span id='count'>5</span> 秒后自动跳转"),$("#regLoginModal").modal("show");var o=5,e=setInterval(function(){o--,$("#count").text(o),0==o&&(clearInterval(e),location.href="login.php")},1e3)}else $("#regLoginModal .modal-body").html("<span class='glyphicon glyphicon-remove'></span>"+s.msg),$("#regLoginModal").modal("show"),console.log(s.msg)},"json")}),$("#loginForm").bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{username:{message:"用户名验证失败",validators:{notEmpty:{message:"用户名不能为空"},stringLength:{min:6,max:18,message:"用户名长度必须在6~18位之间"}}},password1:{validators:{notEmpty:{message:"密码必须填写"},stringLength:{min:6,message:"密码长度必须大于6位"}}}}}).on("success.form.bv",function(s){s.preventDefault();var o=$(s.target),e=(o.data("bootstrapValidator"),o.serialize());$.post("api/checkLogin.php",e,function(s){if(console.log("服务器返回结果",s),$("#regLoginModal .modal-title").text("用户登录提示"),s.isSuccess){$("#regLoginModal .modal-body").html("<span class='glyphicon glyphicon-ok'></span>"+s.msg+"等待 <span id='count'>5</span> 秒后自动跳转"),$("#regLoginModal").modal("show");var o=5,e=setInterval(function(){o--,$("#count").text(o),0==o&&(clearInterval(e),location.href="personal.php")},1e3)}else $("#regLoginModal .modal-body").html("<span class='glyphicon glyphicon-remove'></span>"+s.msg),$("#regLoginModal").modal("show"),console.log(s.msg)},"json")}),$("#borrowForm").bootstrapValidator({message:"This value is not valid",fields:{borrowAmount:{validators:{notEmpty:{message:"必填"},digits:{message:"只能填写数字"}}},currentRate:{validators:{notEmpty:{message:"必填"},regexp:{regexp:/^\d+(\.\d+)?$/i,message:"只能填写数字。"}}},minAmount:{validators:{notEmpty:{message:"必填"},digits:{message:"只能填写数字"}}},maxAmount:{validators:{notEmpty:{message:"必填"},digits:{message:"只能填写数字"}}},rewardAmount:{validators:{notEmpty:{message:"必填"},regexp:{regexp:/^\d+(\.\d+)?$/i,message:"只能填写数字。"}}},borrowTitle:{validators:{notEmpty:{message:"借款标题必填"}}},description:{validators:{notEmpty:{message:"必填"},stringLength:{min:10,max:500,message:"长度不能小于10位或超过500位"}}}}}).on("success.form.bv",function(s){s.preventDefault();var o=$(s.target),e=(o.data("bootstrapValidator"),o.serialize());$.post("api/borrowAdd.php",e,function(s){if(console.log("服务器返回结果",s),!s.isSuccess)return alert(s.msg),!1;alert(s.msg+"请等待平台审核通过!"),location.href="invest.php?mid=1"},"json")})});